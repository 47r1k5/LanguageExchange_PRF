<div class="create-class-container">
  <h2>Create New Class</h2>
  <form [formGroup]="createForm" (ngSubmit)="onSubmit()" class="create-form">

    <mat-form-field appearance="fill">
      <mat-label>Class Name</mat-label>
      <input matInput formControlName="name" />
      <mat-error *ngIf="createForm.get('name')?.hasError('required')">Name is required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Description</mat-label>
      <textarea matInput formControlName="description"></textarea>
      <mat-error *ngIf="createForm.get('description')?.hasError('required')">Description is required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Language Taught</mat-label>
      <mat-select formControlName="learn_language">
        <mat-option *ngFor="let lang of languagesList$ | async" [value]="lang">{{ lang }}</mat-option>
      </mat-select>
      <mat-error *ngIf="createForm.get('learn_language')?.hasError('required')">Required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Language Used in Class</mat-label>
      <mat-select formControlName="speak_language">
        <mat-option *ngFor="let lang of languagesList$ | async" [value]="lang">{{ lang }}</mat-option>
      </mat-select>
      <mat-error *ngIf="createForm.get('speak_language')?.hasError('required')">Required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Level</mat-label>
      <mat-select formControlName="level">
        <mat-option *ngFor="let lvl of levelsList" [value]="lvl">{{ lvl }}</mat-option>
      </mat-select>
      <mat-error *ngIf="createForm.get('level')?.hasError('required')">Required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Available Spots</mat-label>
      <input matInput type="number" formControlName="free_space" min="1" />
      <mat-error *ngIf="createForm.get('free_space')?.hasError('required')">Required</mat-error>
      <mat-error *ngIf="createForm.get('free_space')?.hasError('min')">Must be at least 1</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Date</mat-label>
      <input matInput [matDatepicker]="dp" formControlName="date" />
      <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
      <mat-datepicker #dp></mat-datepicker>
      <mat-error *ngIf="createForm.get('date')?.hasError('required')">Required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Start Time</mat-label>
      <input matInput type="time" formControlName="startTime" />
      <mat-error *ngIf="createForm.get('startTime')?.hasError('required')">Required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>End Time</mat-label>
      <input matInput type="time" formControlName="endTime" />
      <mat-error *ngIf="createForm.get('endTime')?.hasError('required')">Required</mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Location</mat-label>
      <input matInput formControlName="loc" />
      <mat-error *ngIf="createForm.get('loc')?.hasError('required')">Required</mat-error>
    </mat-form-field>

    <div class="buttons">
      <button mat-raised-button color="primary" type="submit" [disabled]="isLoading">Create</button>
      <button mat-button type="button" (click)="onCancel()">Cancel</button>
    </div>

    <p class="error" *ngIf="errorMessage">{{ errorMessage }}</p>
  </form>
</div>